require=function e(t,n,o){function r(c,s){if(!n[c]){if(!t[c]){var i="function"==typeof require&&require;if(!s&&i)return i(c,!0);if(a)return a(c,!0);var p=new Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p}var l=n[c]={exports:{}};t[c][0].call(l.exports,function(e){var n=t[c][1][e];return r(n?n:e)},l,l.exports,e,t,n,o)}return n[c].exports}for(var a="function"==typeof require&&require,c=0;c<o.length;c++)r(o[c]);return r}({common:[function(e,t,n){"use strict";cc._RF.push(t,"0aff6ovTK5N44pO+pA+DbVM","common");var o={liuyifei:400,eva_green:500,gakki:480};t.exports={playerInfo:{},mountInfo:{base_speed:500,float_speed:1.8,float_speed_acceleration:.05},targetInfo:{speed:400,name:"gakki"},SelectTarget:function(e){var t=["gakki","eva_green","liuyifei"][e];this.targetInfo.name=t,o[t]&&(this.targetInfo.speed=o[t])}},cc._RF.pop()},{}],game_manager:[function(e,t,n){"use strict";cc._RF.push(t,"b92e3N9npRHXaRjHudJNxd2","game_manager");var o=e("./net/request"),r=(e("common"),r||function(){var e={};return e.emitter=new cc.Node("game_manager"),console.log(e.emitter),e.start=function(){var e=cc.director.getCollisionManager();e.enabled=!0,cc.director.loadScene("main")},e.end=function(e){o.CatchLolita(e,function(e){console.log(e);cc.director.loadScene("end",function(t){var n=cc.director.getScene(),o=n.children[0].getComponent("ui_end");o.init(e.fans)})})},e.restart=function(){e.emitter=new cc.Node("game_manager"),cc.director.loadScene("begin")},e}());t.exports=r,cc._RF.pop()},{"./net/request":"request",common:"common"}],main:[function(e,t,n){"use strict";cc._RF.push(t,"bee3a1CvJNBoYhcZiC5zxvX","main"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){}}),cc._RF.pop()},{}],player:[function(e,t,n){"use strict";cc._RF.push(t,"10cf4JEH8FKy5o9XIyEOnR6","player");var o=e("common"),r=e("game_manager");cc.Class({"extends":cc.Component,properties:{MaxPlayerBaseSpeed:200,PlayerAcceleration:600,MaxSpeedFloated:1.6,SpeedFloatRecovery:.6,SpeedFloatAcceleration:.1,touchParticle:cc.ParticleSystem},onLoad:function(){console.log(r),this.init(),this.MaxPlayerBaseSpeed=o.mountInfo.base_speed,this.MaxSpeedFloated=o.mountInfo.float_speed,this.SpeedFloatAcceleration=o.mountInfo.float_speed_acceleration},init:function(){this.current_speed=0,this.enableInput=!1,this.baseSpeed=0,this.MaxSpeedFloated=o.mountInfo.float_speed,this.current_speed_float=1,this.registerInput(),this.passed_tm=0},registerInput:function(){var e=this;cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(t,n){if(e.enableInput){var o=e.node.parent.convertTouchToNodeSpaceAR(t);return e.touchParticle.node.x=o.x,e.touchParticle.node.y=o.y,e.touchParticle.resetSystem(),e.touchParticle.enabled=!0,!0}},onTouchMoved:function(t,n){!e.enableInput},onTouchEnded:function(t,n){e.enableInput&&(e.current_speed_float+=e.SpeedFloatAcceleration,e.current_speed_float=Math.min(e.current_speed_float,e.MaxSpeedFloated),r.emitter.emit("player_speed_floating",{msg:{max:e.MaxSpeedFloated,current:e.current_speed_float}}))}},e.node)},update:function(e){this.passed_tm+=e,this.baseSpeed+=this.PlayerAcceleration*e,this.baseSpeed>this.MaxPlayerBaseSpeed&&(this.baseSpeed=this.MaxPlayerBaseSpeed,this.enableInput=!0),r.emitter.emit("player_base_speed_change",{max:this.MaxPlayerBaseSpeed,current:this.baseSpeed}),this.current_speed_float-=this.SpeedFloatRecovery*e,r.emitter.emit("player_speed_floating",{max:this.MaxSpeedFloated,current:this.current_speed_float}),this.current_speed_float=Math.max(this.current_speed_float,1),this.current_speed=this.baseSpeed*this.current_speed_float},onCollisionEnter:function(e,t){console.log(o.playerInfo.nickname+" catch lolita!!!"),r.end(this.passed_tm)}}),cc._RF.pop()},{common:"common",game_manager:"game_manager"}],request:[function(e,t,n){"use strict";cc._RF.push(t,"ed43dIzl+hIbKUafMkc5ezW","request");var o=e("../lib/simple-request"),r=e("../common"),a=a||function(){var e={},t="http://test.game.xiaoyaoai.cn:30099";return e.CatchLolita=function(e,n){o.post(t,"/user/be_catch",{},{target_id:r.targetInfo.name,nickname:r.playerInfo.nickname,tm:e},n)},e}();t.exports=a,cc._RF.pop()},{"../common":"common","../lib/simple-request":"simple-request"}],scroll:[function(e,t,n){"use strict";cc._RF.push(t,"2efa475NSNPNrsh+QanyzHg","scroll"),cc.Class({"extends":cc.Component,properties:{player:cc.Node},onLoad:function(){this.playerController=this.player.getComponent("player")},update:function(e){for(var t=this.playerController.current_speed*e,n=0,o=0;o<this.node.childrenCount;o++){var r=this.node.children[o];r.y-=t,r.y>n&&(n=r.y)}for(var a=0;a<this.node.childrenCount;a++){var c=this.node.children[a];c.y<-(1.5*c.height)&&(c.y=n+c.height)}}}),cc._RF.pop()},{}],"simple-request":[function(e,t,n){"use strict";cc._RF.push(t,"363391WEHNNLpzBRKb/3v+U","simple-request");var o=3e4,r=r||function(){var e={};e.get=function(e,n,r,a){var c=new XMLHttpRequest,s=t(r);console.log("get string: "+e+n+s),c.open("GET",e+n+s,!0),c.timeout=o,c.onload=function(){var e=JSON.parse(c.responseText);a&&a.call(this,e)},c.ontimeout=function(){a&&a.call(this,{timeout:!0})},c.send()},e.post=function(e,n,r,a,c){var s=new XMLHttpRequest;console.log("post",e+n+t(r)),s.open("POST",e+n+t(r),!0),s.setRequestHeader("Content-Type","application/json"),s.timeout=o,s.onload=function(){var e=JSON.parse(s.responseText);c&&c.call(this,e)},s.ontimeout=function(){c&&c.call(this,{timeout:!0})},console.log("xhr.onload",a);var i=a?JSON.stringify(a):"";s.onerror=function(e){console.log("server error "+e),c&&c.call(this,{timeout:!0})},s.send(i)},e.jump=function(e,n){var o=t(n);console.log("jump to url: "+e+o),window.location.href=e+o};var t=function(e,t){var n="";if(e){var o=void 0==t||t;for(var r in e)o?(o=!1,n+="?"):n+="&",n+=r+"="+e[r]}return n};return e}();t.exports=r,cc._RF.pop()},{}],target:[function(e,t,n){"use strict";cc._RF.push(t,"6a305F/xYBFj6frW/RuNUTZ","target");var o=e("common");cc.Class({"extends":cc.Component,properties:{player:cc.Node,speed:400,speakDuration:3,speakTextBox:cc.Label},onLoad:function(){console.log("target on loaded"),console.log(o.targetInfo),this.playerController=this.player.getComponent("player"),this.speak_duration_now=0,this.speed=o.targetInfo.speed;var e=this.node.getComponent(cc.Sprite);e.spriteFrame=new cc.SpriteFrame(cc.url.raw("Texture/target_"+o.targetInfo.name+".png"))},update:function(e){var t=this.speed-this.playerController.current_speed;this.node.y+=t*e,this.speak_duration_now+=e,this.speak_duration_now>this.speakDuration&&(this.speakTextBox.enabled=!1)}}),cc._RF.pop()},{common:"common"}],ui_begin:[function(e,t,n){"use strict";cc._RF.push(t,"67655elHOdPsp2u/VSmhf6P","ui_begin");var o=e("common"),r=e("game_manager");cc.Class({"extends":cc.Component,properties:{ebox_nickname:cc.EditBox,toggleGroup:cc.ToggleGroup},onLoad:function(){var e=this;this.node.on("touchend",function(t){if(console.log("touchend"),o.playerInfo.nickname=e.ebox_nickname.string,""==o.playerInfo.nickname)return void alert("昵称不能为空");for(var n=0;n<e.toggleGroup.toggleItems.length;n++){var a=e.toggleGroup.toggleItems[n];console.log(a.name),a.isChecked&&o.SelectTarget(n)}r.start()},this)}}),cc._RF.pop()},{common:"common",game_manager:"game_manager"}],ui_end:[function(e,t,n){"use strict";cc._RF.push(t,"f60deSZV2dHjoaQ5BGbW+8J","ui_end"),cc.Class({"extends":cc.Component,properties:{BtnRestart:cc.Button,LabelRank:cc.Label},onLoad:function(){this.BtnRestart.node.on("touchend",function(e){console.log("touchend"),cc.director.loadScene("begin")},this)},init:function(e){this.LabelRank.string="",console.log(e.length);for(var t=0;t<e.length;t++)this.LabelRank.string+=t+1+"."+e[t].nickname+":"+e[t].tm.toFixed(2)+"\n"}}),cc._RF.pop()},{}],ui_main:[function(e,t,n){"use strict";cc._RF.push(t,"a191bhJYSpCOLGrL0KJ9P9a","ui_main");var o=e("common"),r=e("game_manager");cc.Class({"extends":cc.Component,properties:{speed_progress:cc.ProgressBar,speed_progress_float:cc.ProgressBar,lb:cc.Label},onLoad:function(){console.log("main ui on loaded"),this.init(),this.speed_progress.progress=0,this.speed_progress_float.progress=0;var e="基础速度:"+o.mountInfo.base_speed+"\n";e+="浮动速度:"+o.mountInfo.float_speed+"\n",e+="加速效果:"+o.mountInfo.float_speed_acceleration+"\n",this.lb.string=e},init:function(){var e=this;r.emitter.on("player_base_speed_change",function(t){e.speed_progress&&(e.speed_progress.progress=t.detail.current/t.detail.max)}),r.emitter.on("player_speed_floating",function(t){e.speed_progress_float&&(e.speed_progress_float.progress=(t.detail.current-1)/(t.detail.max-1))})},update:function(e){}}),cc._RF.pop()},{common:"common",game_manager:"game_manager"}]},{},["common","game_manager","simple-request","main","request","player","scroll","target","ui_begin","ui_end","ui_main"]);
//# sourceMappingURL=project.js.map